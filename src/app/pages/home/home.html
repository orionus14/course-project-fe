<div class="max-w-content mx-auto p-4 sm:p-6 md:p-8">
    <!-- User controls -->
    <div class="flex justify-end mb-6">
        <button (click)="logout()"
            class="bg-primary-color text-white py-3 px-6 rounded-xl shadow-light-orange hover:opacity-90 transition">
            üîí –í–∏–π—Ç–∏
        </button>
    </div>

    <div class="voice-assistant-container bg-light-gray p-6 rounded-2xl shadow-light-gray">
        <h2 class="text-2xl font-semibold mb-6 text-dark-gray">–ì–æ–ª–æ—Å–æ–≤–∏–π –ø–æ–º—ñ—á–Ω–∏–∫</h2>

        <!-- –í–∏–±—ñ—Ä —Å–ø–æ—Å–æ–±—É –≤–≤–µ–¥–µ–Ω–Ω—è -->
        <div class="input-method flex flex-col sm:flex-row sm:gap-6 mb-6">
            <label class="flex items-center gap-2">
                <input type="radio" name="inputMethod" value="record" [(ngModel)]="inputMethod" class="form-radio">
                üé§ –ó–∞–ø–∏—Å –∑ –º—ñ–∫—Ä–æ—Ñ–æ–Ω—É
            </label>
            <label class="flex items-center gap-2">
                <input type="radio" name="inputMethod" value="upload" [(ngModel)]="inputMethod" class="form-radio">
                üìÅ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–∞–π–ª
            </label>
        </div>

        <!-- –í–∏–±—ñ—Ä –¥–≤–∏–∂–∫–∞ -->
        <div class="engine-selection flex flex-col sm:flex-row sm:gap-6 mb-6">
            <label class="flex items-center gap-2">
                <input type="radio" name="engine" value="whisper" [(ngModel)]="engine" class="form-radio">
                Whisper (EN)
            </label>
            <label class="flex items-center gap-2">
                <input type="radio" name="engine" value="custom" [(ngModel)]="engine" class="form-radio">
                –í–ª–∞—Å–Ω–∞ ASR (UA)
            </label>
        </div>

        <!-- –ó–∞–ø–∏—Å –∑ –º—ñ–∫—Ä–æ—Ñ–æ–Ω—É -->
        @if(inputMethod === 'record') {
        <div class="recording-controls flex flex-col sm:flex-row sm:items-center gap-4 mb-6">
            <button (click)="startRecording()" [disabled]="recording || loading"
                class="h-14 px-6 bg-primary-color text-white rounded-xl shadow-light-orange hover:opacity-90 transition disabled:bg-medium-gray">
                üé§ –ü–æ—á–∞—Ç–∏ –∑–∞–ø–∏—Å
            </button>
            <button (click)="stopRecording()" [disabled]="!recording || loading"
                class="h-14 px-6 bg-secondary-color text-dark-gray rounded-xl shadow-light-yellow hover:opacity-90 transition disabled:bg-medium-gray">
                ‚èπÔ∏è –ó—É–ø–∏–Ω–∏—Ç–∏
            </button>
            @if(recording) {
            <span class="text-primary-color font-semibold ml-2">‚óè –ó–∞–ø–∏—Å...</span>
            }
        </div>
        }

        <!-- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–∞–π–ª—É -->
        @if(inputMethod === 'upload') {
        <div class="upload-controls flex flex-col sm:flex-row sm:items-center gap-4 mb-6">
            <input type="file" accept="audio/*" (change)="onFileSelected($event)" #fileInput
                class="h-14 w-full sm:w-72 rounded-xl border border-border-gray px-4 shadow-light-gray">
            <button (click)="uploadFile()" [disabled]="!selectedFile || loading"
                class="h-14 px-6 bg-primary-color text-white rounded-xl shadow-light-orange hover:opacity-90 transition disabled:bg-medium-gray">
                üì§ –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ —Ä–æ–∑–ø—ñ–∑–Ω–∞—Ç–∏
            </button>
        </div>
        }

        <!-- –ß–µ–∫–±–æ–∫—Å –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∞—É–¥—ñ–æ -->
        <div class="save-option mb-6">
            <label class="flex items-center gap-2">
                <input type="checkbox" [(ngModel)]="saveAudio" class="form-checkbox">
                –ó–±–µ—Ä–µ–≥—Ç–∏ –∞—É–¥—ñ–æ —Ñ–∞–π–ª
            </label>
        </div>

        <!-- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è -->
        @if(loading) {
        <div class="loading mb-6">
            <p class="text-dark-gray font-medium">‚è≥ –û–±—Ä–æ–±–∫–∞...</p>
        </div>
        }

        <!-- –Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–ø–∏—Å—ñ–≤ -->

        <div class="records-history mt-6">
            <button (click)="showRecords = !showRecords"
                class="mb-4 h-12 px-6 bg-secondary-color text-dark-gray rounded-xl shadow-light-yellow hover:opacity-90 transition">
                üîΩ –Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–ø–∏—Å—ñ–≤
            </button>

            @if(showRecords) {
            <!-- –°–ø–∞–¥–Ω–µ –º–µ–Ω—é -->
            <div class="flex flex-col gap-4 max-h-96 overflow-y-auto">
                <button (click)="loadRecords()" [disabled]="loading"
                    class="mb-2 h-12 px-6 bg-secondary-color text-dark-gray rounded-xl shadow-light-yellow hover:opacity-90 transition disabled:bg-medium-gray">
                    üîÑ –û–Ω–æ–≤–∏—Ç–∏
                </button>

                @if(records.length > 0) {
                <div class="records-list flex flex-col gap-4">
                    @for(record of records; track record.id) {
                    <div
                        class="record-item flex flex-col sm:flex-row sm:justify-between items-start sm:items-center p-4 bg-white rounded-xl shadow-light-gray">
                        <div class="record-content mb-2 sm:mb-0">
                            <p class="record-text text-dark-gray">{{ record.text }}</p>
                            <small class="text-medium-gray">{{ record.created_at | date:'short' }} | {{ record.engine
                                }}</small>
                        </div>
                        <div class="record-actions flex gap-2">
                            @if(record.audio_filename) {
                            <button (click)="playAudio(record.audio_filename)"
                                class="px-4 py-2 bg-primary-color text-white rounded-xl shadow-light-orange hover:opacity-90 transition">
                                ‚ñ∂Ô∏è
                            </button>
                            }
                            <button (click)="deleteRecord(record.id)"
                                class="px-4 py-2 bg-error-message text-white rounded-xl shadow-light-orange hover:opacity-90 transition">
                                üóëÔ∏è
                            </button>
                        </div>
                    </div>
                    }
                </div>
                } @else {
                <p class="no-records text-medium-gray">–ù–µ–º–∞—î –∑–∞–ø–∏—Å—ñ–≤</p>
                }
            </div>
            }
        </div>

    </div>
</div>